plot(sm(b, 3))+ l_fitRaster() + l_fitContour()
}
p3 <- ggdraw(w)
plot_grid(p1, p2, p3,
layout_matrix = matrix(c(1,2,3,3), 2, 2),
labels="auto")
p1
q <- function() {
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
}
p1 <- ggdraw(q)
p <- function() {
par(
mar = c(3, 3, 3, 3),
mgp = c(2, 1, 0)
)
plot(sm(b, 2))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
}
p2 <- ggdraw(p)
w <- function() {
par(
mar = c(3, 3, 3, 3),
mgp = c(2, 1, 0)
)
plot(sm(b, 3))+ l_fitRaster() + l_fitContour()
}
p3 <- ggdraw(w)
p1
q <- function() {
par(
mar = c(1, 1, 1, 1),
mgp = c(2, 1, 0)
)
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
}
p1 <- ggdraw(q)
p1
q <- function() {
par(
mar = c(2, 2, 2, 2),
mgp = c(2, 1, 0)
)
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
}
p1 <- ggdraw(q)
p1
par(mar = c(2, 2, 2, 2),
mgp = c(2, 1, 0))
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
par(mar = c(2, 2, 2, 2))
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
p <- function() {
par(
mar = c(3, 3, 3, 3)
)
plot(sm(b, 2))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+theme_bw()
}
p1 <- ggdraw(p)
p1
?ggdraw
b <- getViz(fit44)
p1 <- plot(sm(b, 4))+
l_fitRaster() +
l_fitContour()+
theme_bw()+
theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
title("a")
b <- getViz(fit44)
p1 <- plot(sm(b, 4))+
l_fitRaster() +
l_fitContour()+
theme_bw()+
theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
labs(title = "a")
p2 <- plotSlice(x = sm(b, 5),
fix = list("doy" = c(1, 92, 182,274)))+
l_fitRaster() +
l_fitContour() +
theme_bw()+
theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+ coord_fixed(ratio = 1.5)
p3 <- plotSlice(x = sm(b, 6),
fix = list("Year" = seq(1990,2015,by=5)))+l_fitRaster() +           l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5)
gridPrint(p1, p2, p3, layout_matrix = matrix(c(1, 2,2,3, 3, 3), 3, 2))
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.caption = element_text(hjust = 0))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.caption = element_text(hjust = 1))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.caption = element_text(hjust = -1))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.caption = element_text(hjust = 2))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title.position = element_text(hjust = 2))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = 2))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = 0))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.5))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = 0.5))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.001))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.01))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.1))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.05))+
labs(title = "a")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.05))+
labs(title = "(a)")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.08))+
labs(title = "(a)")
plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
p1 <- plot(sm(b, 1))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
p2 <- plot(sm(b, 2))+ l_fitLine(linetype = 1) +
l_ciLine(colour = 2)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(b)")
p3 <- plotSlice(x = sm(b, 6),
fix = list("Year" = seq(1990,2015,by=5)))+l_fitRaster() +                l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5) +
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
?l_fitLine
?layout_matrix
?matrix
load("files/fit.Rdata")
rm(data, p1, p2, p3 ,fit)
b <- getViz(fit44)
p1 <- plot(sm(b, 1))+ l_fitLine(linetype = 1, size = 0.5) +
l_ciLine(colour = 2, size = 0.5)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
p2 <- plot(sm(b, 2))+ l_fitLine(linetype = 1, size = 0.5) +
l_ciLine(colour = 2, size = 0.5)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(b)")
p3 <- plotSlice(x = sm(b, 6),
fix = list("Year" = seq(1990,2015,by=5)))+l_fitRaster() +                l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5) +
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
gridPrint(p1, p2, p3,
layout_matrix = matrix(c(1,2,1,2,1,2,3,3,3,3), 2, 5, byrow = FALSE))
gridPrint(p1, p2, p3,
layout_matrix = matrix(c(1,2,3,3), 2, 2, byrow = FALSE))
b <- getViz(fit44)
p1 <- plot(sm(b, 1))+ l_fitLine(linetype = 1, size = 0.5) +
l_ciLine(colour = 2, size = 0.5)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(a)")
p2 <- plot(sm(b, 2))+ l_fitLine(linetype = 1, size = 0.5) +
l_ciLine(colour = 2, size = 0.5)+  theme_bw()+
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(b)")
p3 <- plot(x = sm(b, 3))+l_fitRaster() +
l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5) +
theme(legend.position='hidden',
plot.title = element_text(hjust = -0.07))+
labs(title = "(c)")
p3 <- plot(x = sm(b, 3))+l_fitRaster() +
l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5) +
theme(plot.title = element_text(hjust = -0.07))+
labs(title = "(c)")
gridPrint(p1, p2, p3,
layout_matrix = matrix(c(1,2,3,3), 2, 2, byrow = FALSE))
p3 <- plot(x = sm(b, 3))+l_fitRaster() +
l_fitContour() +
theme_bw()+
#  theme(legend.position='hidden')+
#      scale_fill_gradientn(limits = c(-0.5,0.5), colors = hcl.colors(10))+
coord_fixed(ratio = 1.5) +
theme(plot.title = element_text(hjust = -0.07))+
labs(title = "(c)")
gridPrint(p1, p2, p3,
layout_matrix = matrix(c(1,2,3,3), 2, 2, byrow = FALSE))
load("files/fit.Rdata")
rm(data, p1, p2, p3 ,fit)
summary(fit44)
index <- character()
for(i in 1:4){
for(j in 1:4){
index <- c(index, paste0("$Model_{",i,j,"}$"))
}
}
load("files/sub.Rdata")
f%>% mutate(distribution = index) %>%
select(-"logLik")%>%
kable(col.names = c("Model","df","AIC","BIC","DER","F test","GLRT"),
caption = '\\label{tab:result} Freedom degree, AIC and BIC of each fitted model, and statistics of F test and GLRT of $model_{i4}$ with $model_{i1}$, $model_{i2}$, and $model_{i3}$ respectively.',
booktabs = TRUE, format = "latex", digits = 2,escape = F) %>%
kable_styling(font_size = 10, latex_options = "hold_position") %>%
pack_rows("$Model_{1\\cdot}$", 1, 4, escape = F) %>%
pack_rows("$Model_{2\\cdot}$", 5, 8, escape = F) %>%
pack_rows("$Model_{3\\cdot}$", 9, 12, escape = F) %>%
pack_rows("$Model_{4\\cdot}$", 13, 16, escape = F)
g <- summary(fit)
data.frame(Estimate = g$p.coeff,
s.e. = g$se[1:3],
t.stat = g$p.t,
p.value = paste0("<0.0001")) %>%
kable(caption = '\\label{tab:coef} Estimated coefficients of covariates in $Model_{44}$.',
booktabs = TRUE, format = "latex", digits = 4, escape = F) %>%
kable_styling(font_size = 10, latex_options = "hold_position")
tidy(fit) %>% mutate(p.value = paste0("<0.0001")) %>% kable(caption = '\\label{tab:term} Analysis of variance for smooth terms in $Model_{44}$',
booktabs = TRUE, format = "latex", digits = 4, escape = F) %>%
kable_styling(font_size = 10, latex_options = "hold_position")
vari <- variog(residUK)
vari.mc <- variog.mc.env(residUK, obj.variog=vari)
q <- function() {
par(
mar = c(3, 3, 3, 3),
mgp = c(2, 1, 0)
)
qq.gam(fit)
}
p1 <- ggdraw(q)
p <- function() {
par(
mar = c(3, 3, 3, 3),
mgp = c(2, 1, 0)
)
plot(vari, envelope.obj=vari.mc)
}
p2 <- ggdraw(p)
plot_grid(p1,p2, ncol=2, labels=paste0("(",letters[1:2],")"), hjust = 0)
data.frame(Error=c("RMSPE","MAPE","MdAPE"),
model=c(2.989879,2.325188,1.860497),
without=c(1.612882,1.247002,0.992226)
)%>%  kable(col.names=c("Error criteria", "Model without covariates","Model with covariates"),
caption = '\\label{tab:MSE} RMSPE, MAPE and MdAPE scores when the model excludes covariates and contains covariates',
booktabs = TRUE, format = "latex", digits = 2) %>%
kable_styling(font_size = 10, latex_options = "hold_position")
load("files/fit.Rdata")
rm(data, p1, p2, p3 ,fit)
b <- getViz(fit44)
?here::here
load("files/fit.Rdata")
rm(data, p1, p2, p3 ,fit,g,residUK,vari,vari.mc,i,j,index)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(maps)
library(geoR)
library(mgcv)
library(kableExtra)
library(cowplot)
library(broom)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(ggspatial)
library(skimr)
library(latex2exp)
library(mgcViz)
?knitr:::is_latex_output
median(15, 14, 16, 15, 17, 16, 15, 14, 15, 16,
17, 16, 15, 14, 16, 17, 15, 25, 18, 16)
x <- c(15, 14, 16, 15, 17, 16, 15, 14, 15, 16, 17, 16, 15, 14, 16, 17, 15, 25, 18, 16)
quantile(x, 0.25)
quantile(x, 0.75)
IQR(x)
15-1.5*1.25
16.25+1.5*1.25
boxplot(x)
mean(x)
sd(x)
(16.1-15)/sd(x)*3
plot(density(x))
x <- matrix(c(13, 24,
22, 55,
17, 35,
20 ,45,
10, 20,
15 ,30,
19, 39,
12 ,19,
18 ,36,
23 ,54), ncol = 2)
sd(x[,1])
sum(x[,1]^2)
sum(x[,1])
View(x)
x <- matrix(c(13, 24,
22, 55,
17, 35,
20 ,45,
10, 20,
15 ,30,
19, 39,
12 ,19,
18 ,36,
23 ,54), ncol = 2,byrow = TRUE)
sum(x[,1])
sum(x[,1]^2)
sum(x[,1]^2)-sum(x[,1])^2
(sum(x[,1])^2-sum(x[,1]^2))/9
sd(x[,1])
sqrt((sum(x[,1])^2-sum(x[,1]^2))/9)
sqrt((sum(x[,1])^2-mean(x[,1])^2))/9)
(sum(x[,1])^2-mean(x[,1])^2)/9
sqrt((sum(x[,1])^2-mean(x[,1])^2)/9)
sd(x[,1])
(3025-16.9^2)/9
sqrt((3025-16.9^2)/9)
?sd
sd
var
sqrt((sum(x[,1])^2-10*mean(x[,1])^2)/9)
sqrt((3025-10*16.9^2)/9)
sd(x[,2])
6526-16.9*35.7*10
492.7/9/4.33/12.91
corr(x[,1],x[,2])
cor(x[,1],x[,2])
lm(x[,2] ~ x[,1])
solve(t^(x[,2])%*%x[,2])%*%t(x[,1])
t^(x[,2]
t^(x[,2])%*%x[,2]
solve(t(x[,2])%*%x[,2])%*%t(x[,1])
t(x[,2])%*%x[,2]
t(x[,2])%*%x[,2]
solve(x[,2]^2)%*%t(x[,1])
x[,2]^2
1/x[,2]^2%*%t(x[,1])
1/x[,2]^2*x[,1]
sum(1/x[,2]^2*x[,1])
lm(x[,2] ~ x[,1])
X <- X[,1]
X <- x[,1]
X[,1] <- 1
fit <- lm(x[,2] ~ x[,1])
summary(fit)
13.599+16*2.917
pnorm(0.975)
pnorm(0.975,50,0.5)
qnorm(0.975)
1.96*0.5
pnorm(-2)
0.75/0.5
pnomr(1.5)
pnorm(1.5)
pnorm(1.5)-pnorm(-1.5)
13*0.05*0.95^11
0.95^12+12*0.05*0.95^11+66*0.05^2*0.95^10+220*0.05^3*0.95^9
1-0.9977636
66*0.05^2*0.95^10+220*0.05^3*0.95^9
3*0.05*0.95*0.95
3/2.4
pnorm(1.25)
1-pnorm(1.25)
-2/5.5*sqrt(90)
pnorm(0.05)
qnorm(0.05)
40+26+50
40+26+52
40/(118)
68/(68+33+31)
68+33+31
(40-118*108/250)^2/118*108
(68-132*108/250)^2/132*108
(26-118*59/250)^2/118*59
(33-132*59/250)^2/132*59
(40-118*108/250)^2/(118*108)+
(68-132*108/250)^2/(132*108)+
(26-118*59/250)^2/(118*59)+
(33-132*59/250)^2/(132*59)+
(52-118*83/250)^2/(118*83)+
(31-132*83/250)^2/(132*83)
0.05063487*250
pchisq(0.975,2)
qchisq(0.975,2)
qchisq(0.95,2)
styler:::style_active_file()
library(mgcViz)
?l_points
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1 %>% kable()
load("F:/thesis_uofg/files/prediction.Rdata")
p1 %>% kable(col.names = c("Year", "Jan 1", "April 1", "July 1", "October 1"))
load("F:/thesis_uofg/files/prediction.Rdata")
p1 %>% kable(col.names = c("Year", "January 1st", "April 1", "July 1", "October 1"))
load("F:/thesis_uofg/files/prediction.Rdata")
p1 %>% kable(col.names = c("Year", "1st January", "1st April", "1st July", "1st October"))
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1
load("F:/thesis_uofg/files/prediction.Rdata")
p1 %>% kable(caption = '\\label{tab:pre} Preditions of average flow in Scotand from 2021 to 2030 by 3 years over the four seasons',
booktabs = TRUE, format = "latex", digits = 2) %>%
kable_styling(font_size = 10, latex_options = "hold_position")
data.frame(Error=c("RMSPE","MAPE","MdAPE"),
model=c(2.989879,2.325188,1.860497),
without=c(1.612882,1.247002,0.992226)
)%>%  kable(col.names=c("Error criteria", "Model without covariates","Model with covariates"),
caption = '\\label{tab:MSE} RMSPE, MAPE and MdAPE scores when the model excludes covariates and contains covariates',
booktabs = TRUE, format = "latex", digits = 2) %>%
kable_styling(font_size = 10, latex_options = "hold_position")
